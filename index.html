<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOFX Days of Christmas</title>

<!-- FAVICON (paths match Assets/favicon_io folder) -->
<link rel="apple-touch-icon" sizes="180x180" href="Assets/favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="Assets/favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="Assets/favicon_io/favicon-16x16.png">
<link rel="icon" href="Assets/favicon_io/favicon.ico">
<link rel="manifest" href="Assets/favicon_io/site.webmanifest">

<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #ffefef, #fff5f0);
    margin: 0;
    padding: 20px 10px 60px;
    display: flex;
    justify-content: center;
    overflow-x: hidden;
    position: relative;
  }

  .wrapper {
    text-align: center;
    width: 100%;
    max-width: 600px;
  }

  /* --- LOGO HEADING --- */
  .heading-logo {
    width: 260px;
    max-width: 80%;
    margin-bottom: 25px;
    filter: drop-shadow(0px 4px 4px rgba(0,0,0,0.35));
  }

  .tree-container {
    position: relative;
    display: inline-block;
  }

  .calendar,
  .trunk {
    position: relative;
    z-index: 2; /* above snowflakes */
  }

  .calendar {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .row {
    display: flex;
    gap: 8px;
    justify-content: center;
  }

  .trunk {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    align-items: center;
  }

  /* Square doors */
  .day {
    position: relative;           /* needed for number overlay */
    width: 90px;
    height: 90px;
    background: #2e8b57;
    border-radius: 12px;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.25);
    transition: transform 0.2s, background 0.2s;
    font-weight: bold;
    font-size: 1.1rem;
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    overflow: hidden;
  }

  .day:hover {
    transform: scale(1.06);
    background: #3fa86e;
  }

  /* trunk colour */
  .trunk .day {
    background: #8b5a2b;
  }

  .trunk .day:hover {
    background: #a66b34;
  }

  /* Opened door with image + overlay number */
  .day.opened {
    background: #000;
    color: transparent;
  }

  .day img.cover {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Number overlay (used closed & opened) */
  .door-number {
    position: relative;
    z-index: 1;
  }

  .day.opened .door-number {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: rgba(255, 255, 255, 0.9);
    color: #000;
    border-radius: 999px;
    padding: 6px 11px;
    border: 1px solid #000;
    font-size: 1rem;
    font-weight: bold;
  }

  /* STAR DOOR */
  .day.star {
    background: #ffe8a0;
    border-radius: 0;
    border: 2px solid #ffcc00;
    width: 90px;
    height: 90px;
    padding: 0;
    clip-path: polygon(
      50% 0%,
      61% 35%,
      98% 35%,
      68% 57%,
      79% 91%,
      50% 70%,
      21% 91%,
      32% 57%,
      2% 35%,
      39% 35%
    );
    box-shadow: 0 4px 10px rgba(255, 204, 0, 0.5);
    color: #8b4a00;
  }

  .day.star.opened {
    clip-path: inherit;
    background: #ffe39a;
    overflow: hidden;
  }

  .day.star img.cover {
    clip-path: inherit;
  }

  /* Snowflakes – now BEHIND the tree (z-index: 0) */
  .snowflake {
    position: fixed;
    top: -10px;
    color: #fff;
    font-size: 1em;
    user-select: none;
    pointer-events: none;
    z-index: 0;
    animation-name: fall;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
  }

  @keyframes fall {
    0%   { transform: translateY(0) rotate(0deg); }
    100% { transform: translateY(100vh) rotate(360deg); }
  }

  /* Modal */
  #albumModal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 20;
    padding: 20px;
    box-sizing: border-box;
  }

  #albumContent {
    background: #fff0f0;
    padding: 20px;
    border-radius: 15px;
    width: 100%;
    max-width: 320px;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    border: 2px solid #d70000;
  }

  #albumCover {
    max-width: 200px;
    max-height: 200px;
    border-radius: 6px;
    display: block;
    margin: 10px auto 10px;
  }

  #albumTitle {
    margin: 5px 0 0;
    font-size: 1rem;
    font-weight: bold;
    color: #d70000;
  }

  button {
    margin-top: 12px;
    padding: 10px 18px;
    border: none;
    background: #d70000;
    color: #fff;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
  }

  button:hover {
    background: #ff1a1a;
  }
</style>
</head>
<body>

<div class="wrapper">
  <!-- Centered logo heading -->
  <img src="Assets/NOFX.jpg" class="heading-logo" alt="NOFX Logo">

  <div class="tree-container">
    <div class="calendar" id="calendar"></div>
    <div class="trunk" id="trunk"></div>
  </div>
</div>

<!-- Modal for big album cover + title -->
<div id="albumModal">
  <div id="albumContent">
    <img id="albumCover" src="" alt="">
    <h2 id="albumTitle"></h2>
    <button onclick="closeModal()">Close</button>
  </div>
</div>

<script>
  /* Album list (title used only in modal) */
  const albums = [
    { title: "Liberal Animation", cover: "Assets/liberal-animation.jpg" },
    { title: "S&M Airlines", cover: "Assets/s-and-m-airlines.jpg" },
    { title: "Ribbed", cover: "Assets/ribbed.jpg" },
    { title: "White Trash, Two Heebs and a Bean", cover: "Assets/white-trash-two-heebs-and-a-bean.jpg" },
    { title: "Punk in Drublic", cover: "Assets/punk-in-drublic.jpg" },
    { title: "Heavy Petting Zoo", cover: "Assets/heavy-petting-zoo.jpg" },
    { title: "So Long and Thanks for All the Shoes", cover: "Assets/so-long-and-thanks-for-all-the-shoes.jpg" },
    { title: "Pump Up the Valuum", cover: "Assets/pump-up-the-valuum.jpg" },
    { title: "The War on Errorism", cover: "Assets/the-war-on-errorism.jpg" },
    { title: "Wolves in Wolves’ Clothing", cover: "Assets/wolves-in-wolves-clothing.jpg" },
    { title: "Coaster", cover: "Assets/coaster.jpg" },
    { title: "Self Entitled", cover: "Assets/self-entitled.jpg" },
    { title: "First Ditch Effort", cover: "Assets/first-ditch-effort.jpg" },
    { title: "Single Album", cover: "Assets/single-album.jpg" },
    { title: "Double Album", cover: "Assets/double-album.jpg" },
    { title: "Half Album", cover: "Assets/half-album.jpg" },
    { title: "Maximum RocknRoll", cover: "Assets/maximum-rocknroll.jpg" },
    { title: "45 or 46 Songs That Weren’t Good Enough to Go on Our Other Records", cover: "Assets/45-or-46-songs.jpg" },
    { title: "The Longest EP", cover: "Assets/the-longest-ep.jpg" },
    { title: "Backstage Passport Soundtrack", cover: "Assets/backstage-passport.jpg" },
    { title: "I Heard They Suck Live!!", cover: "Assets/i-heard-they-suck-live.jpg" },
    { title: "They’ve Actually Gotten Worse Live!", cover: "Assets/theyve-actually-gotten-worse-live.jpg" },
    { title: "The Splits", cover: "Assets/the-splits.jpg" },
    { title: "The Decline", cover: "Assets/the-decline.jpg" }
  ];

  const STAR_ROWS = 1;
  const bodyRowStructure = [1, 2, 3, 4, 5, 6];
  const trunkHeight = 2;
  const POSITIONS_COUNT =
    STAR_ROWS + bodyRowStructure.reduce((a,b)=>a+b,0) + trunkHeight;

  const STORAGE_PREFIX = "nofx_tree_v9_";
  const KEY_ALBUMS = STORAGE_PREFIX + "albums";
  const KEY_DOOR_NUMBERS = STORAGE_PREFIX + "doors";
  const KEY_OPENED = STORAGE_PREFIX + "opened";

  function shuffle(array){
    for(let i=array.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [array[i],array[j]]=[array[j],array[i]];
    }
    return array;
  }

  function load(key,f){ try{const x=localStorage.getItem(key);return x?JSON.parse(x):f;}catch{return f;} }
  function save(key,v){ localStorage.setItem(key,JSON.stringify(v)); }

  let shuffledAlbums = load(KEY_ALBUMS,null);
  if(!shuffledAlbums || shuffledAlbums.length !== albums.length){
    shuffledAlbums = shuffle([...albums]);
    save(KEY_ALBUMS,shuffledAlbums);
  }

  let doorNumbers = load(KEY_DOOR_NUMBERS,null);
  if(!doorNumbers || doorNumbers.length !== POSITIONS_COUNT || doorNumbers[0] !== 24){
    const nums = shuffle(Array.from({length:23},(_,i)=>i+1));
    doorNumbers = [24, ...nums];
    save(KEY_DOOR_NUMBERS,doorNumbers);
  }

  let opened = load(KEY_OPENED,{});

  const calendarEl = document.getElementById("calendar");
  const trunkEl = document.getElementById("trunk");
  const doorEls = [];

  function setDoorContent(el,i){
    const n = doorNumbers[i];
    const album = shuffledAlbums[i];

    if(opened[i]){
      el.classList.add("opened");
      el.innerHTML = `
        <img class="cover" src="${album.cover}" alt="${album.title} cover">
        <span class="door-number">${n}</span>
      `;
    } else {
      el.classList.remove("opened");
      el.innerHTML = `<span class="door-number">${n}</span>`;
    }
  }

  let index = 0;

  /* STAR */
  const starRow = document.createElement("div");
  starRow.className = "row";

  const star = document.createElement("div");
  star.className = "day star";
  setDoorContent(star,index);
  star.onclick = ()=>openDoor(index);

  starRow.appendChild(star);
  calendarEl.appendChild(starRow);
  doorEls[index] = star;
  index++;

  /* TREE BODY */
  bodyRowStructure.forEach(size=>{
    const row=document.createElement("div");
    row.className="row";
    for(let i=0;i<size;i++){
      const d=document.createElement("div");
      d.className="day";
      setDoorContent(d,index);
      d.onclick=(()=>{let ii=index;return()=>openDoor(ii);})();
      row.appendChild(d);
      doorEls[index]=d;
      index++;
    }
    calendarEl.appendChild(row);
  });

  /* TRUNK */
  for(let t=0;t<trunkHeight;t++){
    const d=document.createElement("div");
    d.className="day";
    setDoorContent(d,index);
    d.onclick=(()=>{let ii=index;return()=>openDoor(ii);})();
    trunkEl.appendChild(d);
    doorEls[index]=d;
    index++;
  }

  function openDoor(i){
    opened[i]=true;
    save(KEY_OPENED,opened);

    const album = shuffledAlbums[i];
    document.getElementById("albumCover").src = album.cover;
    document.getElementById("albumTitle").innerText = album.title;

    document.getElementById("albumModal").style.display="flex";

    setDoorContent(doorEls[i],i);
  }

  function closeModal(){
    document.getElementById("albumModal").style.display="none";
  }
  window.closeModal = closeModal;

  /* Snow */
  function snow(){
    const s=document.createElement("div");
    s.className="snowflake";
    s.style.left=Math.random()*window.innerWidth+"px";
    s.style.fontSize=Math.random()*18+12+"px";
    s.style.animationDuration=Math.random()*5+5+"s";
    s.style.opacity=Math.random();
    s.textContent="❄";
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),10000);
  }
  setInterval(snow,200);

</script>

</body>
</html>
